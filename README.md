# Cube Renderer - Vulkan 3D Application

Приложение для рендеринга куба с белыми линиями на гранях в 3D пространстве с возможностью управления камерой.

## Описание

Это приложение демонстрирует:
- Рендеринг куба с белыми линиями на гранях
- Черный фон
- Управление камерой с помощью мыши и клавиатуры
- Ограничение движения камеры в пределах большего куба (5x5x5)

## Управление

- **WASD** - перемещение камеры
- **Мышь** - поворот камеры
- **Space** - подъем вверх
- **Shift** - спуск вниз

## Требования

- C++17 совместимый компилятор
- CMake 3.16+
- Vulkan SDK
- GLFW3
- GLM

## Сборка

```bash
mkdir build
cd build
cmake ..
cmake --build .
```

## Запуск

```bash
./Debug/ciVulkCube.exe
```

## Структура проекта

- `main.cpp` - точка входа в приложение
- `cube.hpp/cpp` - генерация геометрии куба
- `camera.hpp/cpp` - управление камерой
- `cube_app.hpp/cpp` - основное приложение Vulkan
- `vulkan_helpers.hpp/cpp` - вспомогательные функции Vulkan
- `shaders/` - GLSL шейдеры

## Технологии

- **Vulkan** - графический API
- **GLFW** - управление окном и вводом
- **GLM** - математическая библиотека
- **CMake** - система сборки

## Подробное описание файлов

### **main.cpp** - Точка входа
**Назначение**: Главная точка входа приложения, которая инициализирует и запускает Vulkan приложение.

**Ключевые действия**:
- **Строки 1-19**: Простая функция main, которая создает экземпляр `CubeApp` и запускает его
- **Обработка ошибок**: Перехватывает и отображает любые исключения, возникающие во время выполнения
- **Очистка ресурсов**: Обеспечивает правильную очистку при выходе из приложения

### **cube_app.hpp** - Заголовочный файл основного приложения
**Назначение**: Объявляет основной класс `CubeApp`, который управляет всем Vulkan приложением.

**Ключевые модули**:
- **Подключения (строки 1-8)**: Заголовки Vulkan, GLFW, GLM, стандартная библиотека и заголовки проекта
- **Структура UniformBufferObject (строки 10-15)**: Определяет структуру для передачи матриц трансформации в шейдеры
- **Класс CubeApp (строки 17-95)**: Основной класс приложения с членами для управления Vulkan ресурсами
- **Члены Vulkan (строки 19-45)**: Инстанс, физическое устройство, логическое устройство, очереди, поверхности, swap chain
- **Буферы и ресурсы (строки 46-65)**: Вершинные и индексные буферы для куба, сферы и каркаса сферы
- **Конвейеры (строки 66-70)**: Графический конвейер для заполненных объектов и конвейер для каркаса
- **Ресурсы глубины (строки 71-73)**: Изображение глубины, память и view для тестирования глубины
- **Методы инициализации (строки 75-85)**: Методы для создания различных компонентов Vulkan
- **Статические члены (строки 87-95)**: Статический экземпляр приложения и callback для мыши

### **cube_app.cpp** - Реализация основного приложения
**Назначение**: Реализует всю логику Vulkan приложения, включая инициализацию, рендеринг и очистку.

**Ключевые модули**:
- **Конструктор (строки 1-25)**: Инициализирует GLFW, создает окно, настраивает callback для мыши, генерирует геометрию
- **mainLoop() (строки 27-40)**: Основной цикл рендеринга с обработкой событий и обновлением камеры
- **cleanup() (строки 42-85)**: Освобождает все Vulkan ресурсы в правильном порядке
- **initVulkan() (строки 87-105)**: Инициализирует все компоненты Vulkan в правильной последовательности
- **createInstance() (строки 107-130)**: Создает экземпляр Vulkan с поддержкой валидации
- **setupDebugMessenger() (строки 132-140)**: Настраивает отладочные сообщения (если включены)
- **pickPhysicalDevice() (строки 142-155)**: Выбирает подходящее физическое устройство
- **createLogicalDevice() (строки 157-185)**: Создает логическое устройство с очередями
- **createSurface() (строки 187-195)**: Создает поверхность для рендеринга
- **createSwapChain() (строки 197-250)**: Создает swap chain для отображения кадров
- **createImageViews() (строки 252-270)**: Создает views для изображений swap chain
- **createRenderPass() (строки 272-320)**: Создает render pass с привязками цвета и глубины
- **createDescriptorSetLayout() (строки 322-340)**: Создает layout для descriptor sets
- **createGraphicsPipeline() (строки 342-420)**: Создает графический конвейер для заполненных объектов
- **createWireframePipeline() (строки 422-500)**: Создает конвейер для каркаса с линиями
- **createFramebuffers() (строки 502-530)**: Создает framebuffers с привязками цвета и глубины
- **createCommandPool() (строки 532-545)**: Создает пул команд для записи команд рендеринга
- **createDepthResources() (строки 547-570)**: Создает ресурсы для тестирования глубины
- **createTextureImage() (строки 572-580)**: Заглушка для создания текстур (не используется)
- **createVertexBuffer() (строки 582-620)**: Создает вершинные буферы для всех объектов
- **createIndexBuffer() (строки 622-660)**: Создает индексные буферы для всех объектов
- **createUniformBuffers() (строки 662-680)**: Создает uniform буферы для передачи данных в шейдеры
- **createDescriptorPool() (строки 682-700)**: Создает пул дескрипторов
- **createDescriptorSets() (строки 702-720)**: Создает descriptor sets для uniform буферов
- **createCommandBuffers() (строки 722-780)**: Записывает команды рендеринга в command buffers
- **createSyncObjects() (строки 782-800)**: Создает семафоры и fence для синхронизации
- **drawFrame() (строки 802-850)**: Основная функция рендеринга кадра
- **updateUniformBuffer() (строки 852-870)**: Обновляет uniform буфер с матрицами камеры
- **mouseCallback() (строки 872-880)**: Callback для обработки движения мыши
- **Вспомогательные функции (строки 882-950)**: Функции для работы с изображениями и форматами

### **cube.hpp/cpp** - Геометрия куба
**Назначение**: Определяет структуру Vertex и генерирует геометрию куба.

**Ключевые модули**:
- **Структура Vertex (cube.hpp)**: Определяет вершину с позицией и методами для Vulkan
- **generateCubeMesh() (cube.cpp)**: Генерирует вершины и индексы для каркаса куба

### **camera.hpp** - Заголовочный файл камеры
**Назначение**: Объявляет класс Camera и его методы для управления 3D камерой.

**Ключевые модули**:
- **Класс Camera**: Объявляет методы для управления камерой
- **Члены класса**: Позиция, направление, углы поворота, параметры камеры
- **Методы**: processInput(), processMouse(), update(), getViewMatrix(), getProjectionMatrix()

### **camera.cpp** - Реализация системы камеры
**Назначение**: Реализует 3D камеру с управлением движением и поворотом.

**Ключевые модули**:
- **Конструктор камеры (строки 1-15)**: Инициализирует камеру с позицией по умолчанию и настройками
- **processInput() (строки 16-40)**: Обрабатывает движение WASD с ограничением позиции
- **processMouse() (строки 41-65)**: Обрабатывает движение мыши для поворота камеры
- **getViewMatrix() (строки 66-75)**: Генерирует матрицу вида из позиции и ориентации камеры
- **getProjectionMatrix() (строки 76-91)**: Генерирует матрицу проекции с перспективой

### **vulkan_helpers.hpp** - Заголовочный файл вспомогательных функций Vulkan
**Назначение**: Объявляет вспомогательные функции и структуры для операций Vulkan.

**Ключевые модули**:
- **Вспомогательные структуры (строки 1-20)**: Индексы семейств очередей, детали поддержки swap chain
- **Объявления функций (строки 22-27)**: Вспомогательные функции для настройки Vulkan

### **vulkan_helpers.cpp** - Реализация вспомогательных функций Vulkan
**Назначение**: Реализует вспомогательные функции для выбора и валидации устройств Vulkan.

**Ключевые модули**:
- **isDeviceSuitable() (строки 1-20)**: Проверяет, поддерживает ли GPU требуемые функции
- **findQueueFamilies() (строки 21-50)**: Находит семейства очередей для графики и презентации
- **checkDeviceExtensionSupport() (строки 51-70)**: Проверяет требуемые расширения устройства
- **querySwapChainSupport() (строки 71-100)**: Запрашивает возможности swap chain
- **chooseSwapSurfaceFormat() (строки 101-110)**: Выбирает оптимальный формат поверхности
- **chooseSwapPresentMode() (строки 111-125)**: Выбирает оптимальный режим презентации
- **chooseSwapExtent() (строки 126-152)**: Выбирает оптимальный размер swap chain
- **readFile()**: Читает файлы (используется для шейдеров)
- **createBuffer()**: Создает буферы в Vulkan
- **copyBuffer()**: Копирует данные между буферами
- **findMemoryType()**: Находит подходящий тип памяти

### **sphere.hpp/cpp** - Геометрия сферы
**Назначение**: Генерирует геометрию сферы для заполненного объекта и каркаса.

**Ключевые модули**:
- **generateSphereMesh()**: Генерирует треугольники для заполненной сферы
- **generateSphereWireframe()**: Генерирует линии для каркаса сферы

### **shaders/vertex.glsl** - Вершинный шейдер
**Назначение**: Обрабатывает данные вершин и применяет трансформации.

**Ключевые модули**:
- **Вход/Выход (строки 1-8)**: Определяет структуры входа и выхода вершин
- **Uniform буфер (строки 9-12)**: Объявляет uniform буфер для матриц трансформации
- **Главная функция (строки 13-16)**: Применяет модель-вид-проекцию трансформацию к вершинам

### **shaders/fragment.glsl** - Фрагментный шейдер (заполненная сфера)
**Назначение**: Окрашивает поверхность заполненной сферы.

**Ключевые модули**:
- **Выход (строки 1-9)**: Выводит черный цвет для внутренней части заполненной сферы

### **shaders/fragment_lines.glsl** - Фрагментный шейдер (каркас)
**Назначение**: Окрашивает линии каркаса.

**Ключевые модули**:
- **Выход (строки 1-9)**: Выводит белый цвет для линий каркаса

### **CMakeLists.txt** - Конфигурация сборки
**Назначение**: Настраивает систему сборки и компиляцию шейдеров.

**Ключевые модули**:
- **Настройка проекта (строки 1-10)**: Устанавливает версию CMake, название проекта, стандарт C++
- **Компиляция шейдеров (строки 12-35)**: Настраивает glslc для компиляции GLSL в SPIR-V
- **Определение исполняемого файла (строки 37-50)**: Определяет целевой исполняемый файл и исходные файлы
- **Зависимости (строки 52-55)**: Линкует библиотеки Vulkan, GLFW и GLM
- **Пользовательская цель (строки 57-63)**: Копирует скомпилированные шейдеры в выходную директорию

### **README.md** - Документация проекта
**Назначение**: Предоставляет описание проекта, управление и инструкции по сборке.

**Ключевые разделы**:
- **Описание проекта**: 3D визуализация сферы с каркасом
- **Управление**: Движение WASD, поворот мыши
- **Требования**: Vulkan SDK, CMake, vcpkg
- **Инструкции по сборке**: Пошаговое руководство по компиляции
- **Структура проекта**: Обзор файлов и директорий
- **Подробное описание файлов**: Техническое описание каждого компонента

### **.gitignore** - Исключения системы контроля версий
**Назначение**: Исключает артефакты сборки и временные файлы из системы контроля версий.

**Ключевые паттерны**:
- Директории сборки, файлы CMake, скомпилированные объекты
- Исполняемые файлы, скомпилированные шейдеры, файлы IDE
- Файлы, созданные ОС, логи, временные файлы

## Общее описание проекта

Этот проект создает 3D визуализацию с черной сферой, содержащей белые линии каркаса, рендеринг выполняется с использованием Vulkan с правильным тестированием глубины для обеспечения видимости только видимых линий. Камеру можно перемещать вокруг сферы с помощью клавиш WASD и поворота мыши, все в ограниченном 3D пространстве. 